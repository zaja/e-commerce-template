{{!-- Product Gallery Section --}}
{{!-- Displays product images with main image and thumbnails --}}

<section class="sf-section sf-product-gallery" data-section-id="{{sectionId}}">
  <div class="sf-product-gallery__container">
    {{#if product}}
      {{#if product.images.length}}
        {{!-- Main Image --}}
        <div class="sf-product-gallery__main">
          <div class="sf-product-gallery__main-image">
            <img 
              src="{{product.images.[0].url}}" 
              alt="{{or product.images.[0].alt product.name}}"
              id="main-product-image"
              class="sf-product-gallery__img"
            />
            {{#if product.compareAtPrice}}
              <span class="sf-product-gallery__badge sf-product-gallery__badge--sale">
                -{{discountPercentage product.compareAtPrice product.price}}%
              </span>
            {{/if}}
            {{#if product.isNew}}
              <span class="sf-product-gallery__badge sf-product-gallery__badge--new">
                Novo
              </span>
            {{/if}}
          </div>
        </div>

        {{!-- Thumbnails --}}
        {{#if (gt product.images.length 1)}}
          <div class="sf-product-gallery__thumbnails">
            {{#each product.images}}
              <button 
                class="sf-product-gallery__thumb {{#if (eq @index 0)}}sf-product-gallery__thumb--active{{/if}}"
                data-image-url="{{this.url}}"
                data-image-alt="{{or this.alt ../product.name}}"
                onclick="changeMainImage(this)"
              >
                <img src="{{this.url}}" alt="{{or this.alt ../product.name}}" />
              </button>
            {{/each}}
          </div>
        {{/if}}
      {{else}}
        {{!-- No images placeholder --}}
        <div class="sf-product-gallery__main">
          <div class="sf-product-gallery__placeholder">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
              <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
              <circle cx="9" cy="9" r="2"/>
              <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
            </svg>
            <span>Nema slike</span>
          </div>
        </div>
      {{/if}}
    {{else}}
      <div class="sf-product-gallery__empty">
        <p>Proizvod nije pronaÄ‘en</p>
      </div>
    {{/if}}
  </div>
</section>

<script>
function changeMainImage(thumb) {
  const mainImg = document.getElementById('main-product-image');
  if (mainImg && thumb.dataset.imageUrl) {
    mainImg.src = thumb.dataset.imageUrl;
    mainImg.alt = thumb.dataset.imageAlt || '';
    
    // Update active state
    document.querySelectorAll('.sf-product-gallery__thumb').forEach(t => {
      t.classList.remove('sf-product-gallery__thumb--active');
    });
    thumb.classList.add('sf-product-gallery__thumb--active');
  }
}
</script>

{{!-- Styles are in design-sets/starter-flavor/styles/sections.css --}}
